<!DOCTYPE html>
<html>

<head>
    <script src="lib/angular.js"></script>
    <style>
        .fixed-positioned {
            position: fixed;
        }
        .top-position {
            top: 0;
        }
        .full-width {
            width: 100%;
        }
        .no-margin {
            margin: 0;
        }
        .no-padding {
            padding: 0;
        }
        .top-menu-bar {
             height: 65px;
        }
        .layer-1{
            z-index: 1;
        }

        .menu-section {
            /* top level menu*/
        }
        .highlight{
            border: thick solid cornflowerblue;
        }
        .hidden-submenu{
            display: none;
        }
        .show-submenu{
            display: block;
        }

    </style>
</head>
<body ng-app="test-app">

<div id="top-menu"
     class="fixed-positioned top-position full-width no-margin no-padding layer-1"
     ng-controller="NavigationBarController">

    <!-- top menu container-->
    <div class="top-menu-bar"
         ng-mouseleave="menu.showMenuByUrl()">
        <span class="menu-section {{'highlight'|classif: menu.highlight('state.reporting')}}"
              ng-mouseover="menu.showSubMenu('state.reporting')">reporting
        </span>
        
        <span class="menu-section {{'highlight'|classif:menu.highlight('state.campaigns')}}"
              ng-mouseover="menu.showSubMenu('state.campaigns')">campaigns
        </span>
    </div>


    <!-- bottom submenu container-->
    <div class="">
        <div class="hidden-submenu {{'show-submenu'|classif: menu.highlight('state.reporting')}}"w>
            <span class="navigation-link">user reporting</span>
            <span class="navigation-link">campaign reporting</span>
            <span class="navigation-link">adset reporting</span>
        </div>

        <div class="hidden-submenu {{'show-submenu'|classif: menu.highlight('state.campaigns')}}"w>
            <span class="navigation-link">campaigns</span>
            <span class="navigation-link">ad-sets</span>
            <span class="navigation-link">ads</span>
        </div>
    </div>
</div>


<script type="text/javascript">
    angular.module("test-app", [])
            .controller("NavigationBarController", ["$scope", function ($scope) {
                var readInObject = function (obj, expression) {
                    var tokens = expression ? expression.split(".") : [],
                            result = obj;

                    for (var token in tokens) {
                        if(!result){return undefined};
                        result = result[tokens[token]];
                    }
                    return result;
                };
                // on route change success change state
                // watch state from directive, and update view items on state change.
                $scope.menu = {
                    hoverMenu: null,
                    state: {
                        dashboard: false,
                        campaigns: true,
                        reporting: false,
                    },
                    showSubMenu: function(stateName){
                        this.hoverMenu = stateName;
                    },
                    showMenuByUrl: function(){
                        this.hoverMenu = null;
                    },
                    highlight: function(stateName){
                        if(!this.state) return false;
                        var state = readInObject(this.state, stateName);
                        return this.hoverMenu ? (stateName == this.hoverMenu) : state;
                    }
                };

            }])
            .directive("navigationContext", ["navigationBar", function (navigationBar) {

                return {
                    restrict: 'A',
                    transclude: false,
                    scope: false,
                    link: function (scope, element, attrs) {
                        if(!scope.menu.state){
                            console.error("no state found ");
                        }

                        // watch menu.state from controller, change menu state from app state
                        scope.$watch("menu.state", function (newState, oldState) {
                            //change menu state, based on value of state
                        });
                    }
                };
            }]).filter("classif", function(){
                return function(classname, value){
                    return value ? classname : "";
                };
            });
</script>
</body>
</html>
