<!DOCTYPE html>
<html>

<head>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../lib/normalize-3.0.2.css">
    <link rel="stylesheet" href="../../lib/font-awesome-4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/index.css">

    <style>
        /* this style applies to loader while app css is loading*/
        .splash.page{
            position: fixed;
            top:0px;
            left:0px;
            z-index: 9999;

            height: 100vh;
            width: 100vw;
        }
        .splash.page > .content{}
        .splash.page > .content > h1, .splash.page > .content > h5{
            margin: 0 auto;
        }
        .splash.page > .content{
            background-color: black;
            color: white;
            text-align : center;
            height: 100%;
            width: 100%;
        }

        #seed{
            position: fixed;
            top: 0px;
            left: 0px;

            display: block;
            height: 100vh;
            width: 100vw;
            z-index: -1;
        }

        #treniq  #views  ul.deck{
            text-align: left;
        }
        #copyright{
            text-align: center;
        }
        .card-container{
            transition: all 500ms ease;
        }
    </style>

</head>

<body ng-app="treniq">
    <div class="splash page" ng-show="false">
        <div id="loader" class="content" ng-hide="true">
            <h1></h1>
            <h5>loading...</h5>
        </div>
    </div>
    <div id="state" class="home">
    <article id="treniq">
        <div id="top-fixed-bar">
            <div class="app bar">
                <ul class="undo-list">
                    <li class="logo"><a><img src="images/brand.png"></a></li>
                    <li class="search">
                        <span class="fa fa-search"></span>
                        <input type="search" placeholder="search">
                    </li>
                    <li class="icons">
                        <ul class="undo-list">
                            <li class="messages">
                                <span class="fa fa-comments"></span>
                                <label >5</label>
                            </li>
                            <li class="account">
                                <span class="fa fa-user"></span>
                                <label >user</label>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
            <div class="navigation bar">
                <ul class="undo-list">
                    <li class="link home"        ><a >Home</a></li>
                    <li class="link furniture"   ><a >furniture</a></li>
                    <li class="link lighting"    ><a >lighting</a></li>
                    <li class="link decor"       ><a >decor</a></li>
                    <li class="link blog"        ><a >blog</a></li>
                    <li class="link collections" ><a>My collections</a></li>
                </ul>
                <div class="indicator"></div>
            </div>
        </div>
        <!-- Represents route in app, any classes applied to it will be reset  -->
            <ul id="views" class="undo-list">
                <li class="home">
                    <div class="page">
                        <div class="content">
                            <h1>Home</h1>
                            <h3>Best Collection in Town</h3>
                            <p>Fresh Tilled Soil joined with a team of slightly-unhinged storytellers to craft a transmedia game around a simple premise: what if magic were real? Gamers would duel in the real world with wands and spells, relying on their mobile device as an unobtrusive link to a parallel dimension.MoveableCode’s early prototype stole the show at 2012’s TechCrunch Disrupt expo. They were looking for a partner to help define the gameplay experience, and they engaged with Fresh Tilled Soil in October 2012. That’s where the legend begins.</p>
                            <ul class="deck">
                                <li class="card-container" ng-repeat="i in [1,2,3,4,5,6,7,8,9,10,11,12,13]">
                                    <a class="card {{('i'+i)}}">
                                        <div class="picture">
                                            <img src="../../images/wall-lamp.jpg">
                                        </div>
                                        <div class="caption">
                                            <span class="title">Spider III Wall Lamp</span>
                                            <span class="sub-title">Mambo Unlimited Ideas</span>
                                        </div>
                                        <div class="action">
                                            <button class=" fa fa-plus"></button>
                                            <div class="ripple"></div>
                                        </div>
                                        <div class="overlay"></div>
                                    </a>
                                </li>
                            </ul>

                        </div>
                    </div>
                </li>
            </ul>


        <button id="to-top" class="fa fa-chevron-up"></button>
    </article>
    </div>

    <!--<img id="seed" src="images/seed.png">-->

    <script src="../../lib/jquery-2.1.4.min.js"></script>
    <script src="../../lib/angular-1.4.3.js"></script>
    <script src="app.js"></script>
    <script src="../../lab/cards/cards.js"></script>

    <script>
        angular.bootstrap(
                document.getElementById("app"),
                ["treniq"]);

        var init = function(){
            var     app = $("#treniq"),
                    state =
                    reading = function(){
                        app.addClass("reading");
                    },
                    setState = function(name){
                        $("#state").removeClass();
                        $("#state").addClass(name);
                    },
                    navigating = function(){
                        app.removeClass("reading");
                    },
                    lastScrollTop = 0,
                    readingOffset = 50;

            var $page = $(".page");
            $page.on("scroll", function(){
                var scollableContent = $(this),
                        scrollTop = scollableContent.scrollTop(),
                        nearTop = scrollTop < readingOffset,
                        scrollingDown = scrollTop - lastScrollTop > 0;

                (!nearTop && scrollingDown) ? reading() : navigating();
                lastScrollTop = scrollTop;
            });

            var toTop = $("#to-top");
            toTop.on("mousedown touchstart", function() {
                app.addClass("scrolling");
                $page.stop().animate({scrollTop:0}, '500', 'swing', function() {
                    app.removeClass("scrolling");
                });
            });

            var navigation = [
                {
                    name: "home",
                    link: $(".navigation.bar .link.home"),
                    view: $("#views > .home")
                },
                {
                    name: "lighting",
                    link: $(".navigation.bar .link.lighting"),
                    view: $("#views > .lighting")
                },
                {
                    name: "furniture",
                    link: $(".navigation.bar .link.furniture"),
                    view: $("#views > .furniture")
                },
                {
                    name: "decor",
                    link: $(".navigation.bar .link.decor"),
                    view: $("#views > .decor")
                },
                {
                    name: "blog",
                    link: $(".navigation.bar .link.blog"),
                    view: $("#views > .blog")
                }
            ],current = navigation[0];

            navigation.forEach(function(nav){
                nav.link.mouseenter(function(){
                    nav.view.removeClass("no-show");
                    nav.view.addClass("peek");
                    current.view.addClass("drift");
                });

                nav.link.mouseleave(function(){
                    nav.view.removeClass("peek");
                    current.view.removeClass("drift");
                });

                nav.link.click(function(){
                    current.view.removeClass("drift");
                    current.view.addClass("no-show");
                    current.view.removeClass("show");
                    current= nav;
                    current.view.removeClass("no-show");
                    nav.view.addClass("show");
                    setState(current.name);
                    navigating();
                });
            });
            current.view.addClass("show");

            $("#top-fixed-bar").on("mousemove", function(){
                navigating();
            });
            setTimeout(function(){
                $(".home >.page .card").on("click", function(){
                    var page = $(".home > .page");
                    var target = this.parentElement;
                    var topBarOffset = 55
                    var scrollOffset = target.getBoundingClientRect().top
                            + page.scrollTop();
                    page.css("pointer-events", "none");

                    page.animate({scrollTop: scrollOffset - topBarOffset}, function(){
                        var sideBarMargin = 15,
                                sideBarPadding = 0,
                                maskOffset = sideBarMargin + sideBarPadding,
                                targetOffset = maskOffset - target.getBoundingClientRect().left ;

                        reading();
                        $(target).addClass("moving-target");
                        $(".card-container:not(.moving-target)").css("opacity", 0);
                        $(target).css("transform", "translateX("+targetOffset+"px)");
                    });
                });
                console.log("ok");

            }, 0);
        };
        $(document).ready(function(){
            init();

        });


    </script>
    <div id="content-modal">
        <div id="view-card">
            <div class="side-bar">
                <div class="card"></div>
            </div>
            <div class="content"></div>
        </div>

    </div>
</body>
</html>
