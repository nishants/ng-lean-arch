<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Flip</title>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../lib/normalize-3.0.2.css">
    <link rel="stylesheet" href="awe.css">
    <script src="../../lib/jquery-2.1.4.min.js"></script>
    <script src="touch.js"></script>

    <style>
        *{box-sizing: border-box; !important}
        body{
            height: 100%;
            width: 100vw;
            overflow: hidden;
        }
        .page:nth-child(1){
            background-color: #acbbdc;
        }        .page:nth-child(2){
            background-color: #4caf50;
        }
    </style>

</head>
<body>
<ul class="flipper undo-list">
    <li class="page"><h1>Page 1</h1><p>para1</p></li>
    <li class="page"><h1>Page 2</h1><p>para2</p></li>
    <li class="page"><h1>Page 3</h1><p>para3</p></li>
</ul>

    <script>
        var Flippable = function($page){
                    this.$e = $page;
                    this.reset = function(){
                        $page.css("transform", "translateY(-" + ($page.height()) + "px)")
                    };
                    this.moveTo = function(yPosition){
                        $page.css("transform", "translateY(-" + ($page.height() + yPosition) + "px)")
                    };
            },
            Flipper = function($flipper){
                var pages = [], step, index = -1;
                $flipper.find(" > li").each(function(index, page){
                    var $page = $(page);
                    var flippable = new Flippable($page);
                    pages.push(flippable);
                    new Touch($page, {
                        begin: function () {
                            console.log("Page " + index );
                        },
                        move: function (offset) {
                            console.log("x:" + offset.x + ", y:" + offset.y);
                            flippable.moveTo(offset.y);
                        },
                        end: function () {
                            console.log("Page " + index +" gone");
                            flippable.reset();
                        }
                    });
                });

                var next = function () {
                        index > -1 ? pages[index].$e.addClass("closed") : "";
                        index = (index + 1) % pages.length;
                        pages[index].$e.addClass("opened");
                    },
                    previous = function () {
                        pages[index].$e.removeClass("opened");
                        index = Math.abs(index - 1) % pages.length;
                        pages[index].$e.removeClass("closed");
                    };

                this.next  = next;
                this.previous = previous;
                this.next();

            };
        var flipper = new Flipper($(".flipper").first());
        $("body").height($(window.height()));

        $("h1").click(function(){
            flipper.next();
        });

        $("p").click(function(){
            flipper.previous();
        });
    </script>
</body>
</html>